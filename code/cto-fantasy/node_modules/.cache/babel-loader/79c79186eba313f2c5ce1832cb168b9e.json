{"ast":null,"code":"export class LinearFSM {\n  constructor(states = [], delay = 1000) {\n    this.queue = [];\n\n    if (states.some(state => !this.isValid(state))) {\n      throw new Error(\"LinearFSM expects an array of states\");\n    }\n\n    this.delay = delay;\n    this.queue = states;\n  }\n\n  add(state) {\n    if (!this.isValid(state)) {\n      throw new Error(\"add expects a Chapters\");\n    }\n\n    this.queue.push(state);\n  }\n\n  play() {\n    console.log(\"play\", this.queue.length);\n\n    if (this.queue.length) {\n      const state = this.queue.shift();\n      state.enter(state.data, result => {\n        !!state.exit && state.exit(result);\n        setTimeout(() => {\n          console.log(\"setTimeout\");\n          this.play();\n        }, this.delay);\n      });\n    }\n  }\n\n  isValid(states) {\n    return true; //return states.every((state) => state instanceof Chapter);\n  }\n\n}","map":{"version":3,"sources":["/Users/robhill/Projects/Pappa/cto-fantasy/src/modules/game/cto-fantasy/classes/LinearFSM.js"],"names":["LinearFSM","constructor","states","delay","queue","some","state","isValid","Error","add","push","play","console","log","length","shift","enter","data","result","exit","setTimeout"],"mappings":"AAAA,OAAO,MAAMA,SAAN,CAAgB;AAErBC,EAAAA,WAAW,CAACC,MAAM,GAAG,EAAV,EAAcC,KAAK,GAAG,IAAtB,EAA4B;AAAA,SADvCC,KACuC,GAD/B,EAC+B;;AACrC,QAAIF,MAAM,CAACG,IAAP,CAAaC,KAAD,IAAW,CAAC,KAAKC,OAAL,CAAaD,KAAb,CAAxB,CAAJ,EAAkD;AAChD,YAAM,IAAIE,KAAJ,CAAU,sCAAV,CAAN;AACD;;AACD,SAAKL,KAAL,GAAaA,KAAb;AACA,SAAKC,KAAL,GAAaF,MAAb;AACD;;AAEDO,EAAAA,GAAG,CAACH,KAAD,EAAQ;AACT,QAAI,CAAC,KAAKC,OAAL,CAAaD,KAAb,CAAL,EAA0B;AACxB,YAAM,IAAIE,KAAJ,CAAU,wBAAV,CAAN;AACD;;AACD,SAAKJ,KAAL,CAAWM,IAAX,CAAgBJ,KAAhB;AACD;;AAEDK,EAAAA,IAAI,GAAG;AACLC,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoB,KAAKT,KAAL,CAAWU,MAA/B;;AACA,QAAI,KAAKV,KAAL,CAAWU,MAAf,EAAuB;AACrB,YAAMR,KAAK,GAAG,KAAKF,KAAL,CAAWW,KAAX,EAAd;AACAT,MAAAA,KAAK,CAACU,KAAN,CAAYV,KAAK,CAACW,IAAlB,EAAyBC,MAAD,IAAY;AAClC,SAAC,CAACZ,KAAK,CAACa,IAAR,IAAgBb,KAAK,CAACa,IAAN,CAAWD,MAAX,CAAhB;AACAE,QAAAA,UAAU,CAAC,MAAM;AACfR,UAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;AACA,eAAKF,IAAL;AACD,SAHS,EAGP,KAAKR,KAHE,CAAV;AAID,OAND;AAOD;AACF;;AAEDI,EAAAA,OAAO,CAACL,MAAD,EAAS;AACd,WAAO,IAAP,CADc,CAEd;AACD;;AAlCoB","sourcesContent":["export class LinearFSM {\n  queue = [];\n  constructor(states = [], delay = 1000) {\n    if (states.some((state) => !this.isValid(state))) {\n      throw new Error(\"LinearFSM expects an array of states\");\n    }\n    this.delay = delay;\n    this.queue = states;\n  }\n\n  add(state) {\n    if (!this.isValid(state)) {\n      throw new Error(\"add expects a Chapters\");\n    }\n    this.queue.push(state);\n  }\n\n  play() {\n    console.log(\"play\", this.queue.length);\n    if (this.queue.length) {\n      const state = this.queue.shift();\n      state.enter(state.data, (result) => {\n        !!state.exit && state.exit(result);\n        setTimeout(() => {\n          console.log(\"setTimeout\");\n          this.play();\n        }, this.delay);\n      });\n    }\n  }\n\n  isValid(states) {\n    return true;\n    //return states.every((state) => state instanceof Chapter);\n  }\n}\n"]},"metadata":{},"sourceType":"module"}