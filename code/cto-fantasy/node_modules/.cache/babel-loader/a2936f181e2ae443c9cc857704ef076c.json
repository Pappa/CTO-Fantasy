{"ast":null,"code":"import { State } from \"./State\";\nexport class LinearFSM {\n  constructor(delay = 1000) {\n    this.queue = [];\n    this.currentState = null;\n    this.delay = delay;\n  }\n\n  add(input) {\n    const states = Array.isArray(input) ? input : [input];\n    states.forEach(state => {\n      if (!this.isValid(state)) {\n        throw new Error(\"add expects a State\");\n      }\n\n      this.queue.push(state);\n    });\n  }\n\n  next() {\n    if (this.currentState) {\n      this.currentState.exit();\n      this.queue.shift();\n    }\n\n    if (this.queue.length) {\n      this.currentState = this.queue[0];\n\n      if (this.currentState.delay) {\n        setTimeout(() => {\n          this.currentState.enter();\n        }, this.currentState.delay);\n      } else {\n        this.currentState.enter();\n      }\n    }\n  }\n\n  isValid(state) {\n    return state instanceof State;\n  }\n\n}","map":{"version":3,"sources":["/Users/robhill/Projects/Pappa/cto-fantasy/src/modules/game/cto-fantasy/classes/LinearFSM.js"],"names":["State","LinearFSM","constructor","delay","queue","currentState","add","input","states","Array","isArray","forEach","state","isValid","Error","push","next","exit","shift","length","setTimeout","enter"],"mappings":"AAAA,SAASA,KAAT,QAAsB,SAAtB;AAEA,OAAO,MAAMC,SAAN,CAAgB;AAGrBC,EAAAA,WAAW,CAACC,KAAK,GAAG,IAAT,EAAe;AAAA,SAF1BC,KAE0B,GAFlB,EAEkB;AAAA,SAD1BC,YAC0B,GADX,IACW;AACxB,SAAKF,KAAL,GAAaA,KAAb;AACD;;AAEDG,EAAAA,GAAG,CAACC,KAAD,EAAQ;AACT,UAAMC,MAAM,GAAGC,KAAK,CAACC,OAAN,CAAcH,KAAd,IAAuBA,KAAvB,GAA+B,CAACA,KAAD,CAA9C;AACAC,IAAAA,MAAM,CAACG,OAAP,CAAgBC,KAAD,IAAW;AACxB,UAAI,CAAC,KAAKC,OAAL,CAAaD,KAAb,CAAL,EAA0B;AACxB,cAAM,IAAIE,KAAJ,CAAU,qBAAV,CAAN;AACD;;AACD,WAAKV,KAAL,CAAWW,IAAX,CAAgBH,KAAhB;AACD,KALD;AAMD;;AAEDI,EAAAA,IAAI,GAAG;AACL,QAAI,KAAKX,YAAT,EAAuB;AACrB,WAAKA,YAAL,CAAkBY,IAAlB;AACA,WAAKb,KAAL,CAAWc,KAAX;AACD;;AACD,QAAI,KAAKd,KAAL,CAAWe,MAAf,EAAuB;AACrB,WAAKd,YAAL,GAAoB,KAAKD,KAAL,CAAW,CAAX,CAApB;;AACA,UAAI,KAAKC,YAAL,CAAkBF,KAAtB,EAA6B;AAC3BiB,QAAAA,UAAU,CAAC,MAAM;AACf,eAAKf,YAAL,CAAkBgB,KAAlB;AACD,SAFS,EAEP,KAAKhB,YAAL,CAAkBF,KAFX,CAAV;AAGD,OAJD,MAIO;AACL,aAAKE,YAAL,CAAkBgB,KAAlB;AACD;AACF;AACF;;AAEDR,EAAAA,OAAO,CAACD,KAAD,EAAQ;AACb,WAAOA,KAAK,YAAYZ,KAAxB;AACD;;AApCoB","sourcesContent":["import { State } from \"./State\";\n\nexport class LinearFSM {\n  queue = [];\n  currentState = null;\n  constructor(delay = 1000) {\n    this.delay = delay;\n  }\n\n  add(input) {\n    const states = Array.isArray(input) ? input : [input];\n    states.forEach((state) => {\n      if (!this.isValid(state)) {\n        throw new Error(\"add expects a State\");\n      }\n      this.queue.push(state);\n    });\n  }\n\n  next() {\n    if (this.currentState) {\n      this.currentState.exit();\n      this.queue.shift();\n    }\n    if (this.queue.length) {\n      this.currentState = this.queue[0];\n      if (this.currentState.delay) {\n        setTimeout(() => {\n          this.currentState.enter();\n        }, this.currentState.delay);\n      } else {\n        this.currentState.enter();\n      }\n    }\n  }\n\n  isValid(state) {\n    return state instanceof State;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}